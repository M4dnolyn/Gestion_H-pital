{% extends 'base.html' %}

{% block title %}Calendrier des Rendez-vous{% endblock %}

{% block breadcrumb %}
<li class="breadcrumb-item"><a href="{% url 'rendezvous_list' %}">Rendez-vous</a></li>
<li class="breadcrumb-item active">Calendrier</li>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1><i class="fas fa-calendar-alt text-primary me-2"></i> Calendrier</h1>
        <a href="{% url 'rendezvous_create' %}" class="btn btn-primary">
            <i class="fas fa-plus me-1"></i> Nouveau RDV
        </a>
    </div>

    <div class="card shadow">
        <div class="card-body p-0">
            <div id='calendar'></div>
        </div>
    </div>
</div>

<!-- FullCalendar CSS & JS -->
<link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css' rel='stylesheet' />
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js'></script>
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/locales/fr.js'></script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        var calendarEl = document.getElementById('calendar');
        var calendar = new FullCalendar.Calendar(calendarEl, {
            locale: 'fr',
            initialView: 'dayGridMonth',
            headerToolbar: {
                left: 'prev,next today',
                center: 'title',
                right: 'dayGridMonth,timeGridWeek,timeGridDay,listWeek'
            },
            themeSystem: 'bootstrap5',
            events: '{% url "rendezvous_calendar_api" %}',  // URL de l'API
            eventClick: function (info) {
                // Rediriger vers le d√©tail du RDV au clic
                window.location.href = '/rendezvous/' + info.event.id + '/';
            },
            height: 800,
            slotMinTime: '08:00:00',
            slotMaxTime: '19:00:00',
            allDaySlot: false,
            eventTimeFormat: {
                hour: '2-digit',
                minute: '2-digit',
                meridiem: false
            }
        });
        calendar.render();
    });
</script>

<style>
    #calendar {
        margin: 20px;
    }

    .fc-event {
        cursor: pointer;
    }
</style>
{% endblock %}